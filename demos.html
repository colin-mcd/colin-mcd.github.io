<!doctype html>
<html lang="en">

<head>
<style>
.verticalmid {
  vertical-align: middle;
}
.monoinput {
  font-family: monospace;
}
</style>
</head>
<body>

<!-- <label> -->
Definitions
<br>
<textarea cols="60" rows="20" id="boxdefs">
-- Church-encoded datatypes

{- UNIT -}
unit = \x. x

{- ERROR -}
error = \_. error

{- BOOL -}
true = \t. \f. t
false = \t. \f. f
then = unit -- dummy definitions
else = unit -- ^^^^^
if b then t else f = b t f -- make 'if' actually take 5 args, including 'then' and 'else'
and a b = if a then b else false
or a b = if a then true else b
not a = if a then false else true

{- PAIR -}
pair a b = \f. f a b
fst p = p (\a. \b. a)
snd p = p (\a. \b. b)

{- MAYBE -}
none = \s. \n. n
some a = \s. \n. s a

{- NAT -}
zero = \s. \z. z
succ n = \s. \z. s (n s z)

pred n = fst (n (\p. pair (snd p) (succ (snd p))) (pair zero zero))

iszero n = n (\_. false) true

add m n = n succ m
sub m n = n pred m
mul m n = n (add m) 0
exp m n = n (mul m) 1

even n = n not true
odd n = n not false

equal m n =
  if (iszero m) then
    (iszero n)
  else
    (and (not (iszero n)) (equal (pred m) (pred n)))

0 = zero
1 = succ 0
2 = succ 1
3 = succ 2
4 = succ 3
5 = succ 4
6 = succ 5
7 = succ 6
8 = succ 7
9 = succ 8
10 = succ 9
100 = mul 10 10
1000 = mul 10 100
inf = succ inf

{- LIST -}
nil = \c. \n. n
cons h t = \c. \n. c h (t c n)
head xs = xs (\h t. h) error
tail xs = fst (xs (\h p. pair (snd p) (cons h (snd p))) (pair nil nil))
singleton h = cons h nil
append xs ys = xs cons ys
-- pushes a new element to the back of a list
snoc as a = append as (singleton a)
reverse xs = xs (\ x cont acc. cont (cons x acc)) (\xs'. xs') nil
map f xs = xs (\x xs. cons (f x) xs) nil
length xs = xs (\h. succ) zero
repeat n x = n (cons x) nil
cycle xs = append xs (cycle xs)
take n xs = n (\rec xs. cons (head xs) (rec (tail xs))) (\xs. nil) xs
drop n xs = n tail xs
</textarea>
<br>
<br>
<div>
  Evaluation order:
  <input type="radio" id="evalorderapp" name="evalorder" value="strict" checked />
  <label for="evalorderapp">strict</label>
  <input type="radio" id="evalordernorm" name="evalorder" value="lazy" />
  <label for="evalordernorm">lazy</label>
  <br>
  Reduce to:
  <input type="radio" id="evalnf" name="evalto" value="nf" checked />
  <label for="evalnf">normal form</label>
  <input type="radio" id="evalhnf" name="evalto" value="hnf" />
  <label for="evalhnf">head normal form</label>
  <input type="checkbox" id="evalstep" name="evalstep" value="step" />
  <label for="evalstep">show steps</label>
  <br>
  <input type="text" class="monoinput" size="46" id="boxreduce" value="add 2 2"></input>
  <button type="button" id="buttonreduce">Reduce</button>
  <br>
  <!-- <input type="text" class="monoinput" size="46" id="outputreduce" disabled></input> -->
  <div id='outputreduce'></div>
</div>
<br>
<br>
<div style="width: 32em; word-wrap: break-word">
  Böhm's Theorem: any two normal forms are either <i>η</i>-convertible or separable [<a href="#citehuet">1</a>].
  <br>
  This theorem is proven constructively!
  Enter any two terms with finite normal forms below,
  and this computes a discriminator function which returns
  true (<code>λt. λf. t</code>) when given the first as argument,
  and false (<code>λt. λf. f</code>) for the second.
  
  <br>
  <input type="text" class="monoinput" size="22" id="boxbohma" value="odd"></input>
  <input type="text" class="monoinput" size="22" id="boxbohmb" value="even"></input>
  <button type="button" id="buttonbohm" class="runbutton">Separate</button>
  <br>
  <div id='outputbohm'></div>
  <!-- <input type="text" class="monoinput" size="46" id="outputbohm" disabled></input> -->
</div>
<!-- </label> -->

<script type="importmap">
{"imports": {"@bjorn3/browser_wasi_shim": "./node_modules/@bjorn3/browser_wasi_shim/dist/index.js"}}
</script>

<script type="module" src="client.js"></script>
<!--<script type="module" src="client.js"></script>-->

<br>
<br>

<div>
References
<br>
<div id="citehuet">[1] <a href="https://inria.hal.science/inria-00074664/document">Huet, Gérard. An Analysis of Böhm’s Theorem. 2008.</a></div>
</div>
</body>
</html>
